<UserControl x:Class="SFC.Gate.Views.Settings"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:SFC.Gate.Views"
             xmlns:vm="clr-namespace:SFC.Gate.ViewModels"
             xmlns:cnf="clr-namespace:SFC.Gate.Configurations;assembly=SFC.Gate.Core"
             xmlns:cnv="clr-namespace:SFC.Gate.Converters"
             xmlns:gate="clr-namespace:SFC.Gate"
             DataContext="{Binding Source={x:Static vm:Settings.Instance}}"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <TabControl IsEnabled="{Binding Source={x:Static vm:MainViewModel.Instance},Path=CurrentUser.IsAdmin}">
            <TabControl.Effect>
                <BlurEffect Radius="{Binding Source={x:Static vm:MainViewModel.Instance},Path=CurrentUser.IsAdmin,Converter={cnv:BooleanToObject 0, 7},FallbackValue=10}" 
                            KernelType="Gaussian" RenderingBias="Performance"/>
            </TabControl.Effect>
            <TabItem Header="General">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled"
                              Margin="20">
                    <WrapPanel Orientation="Vertical">
                        <GroupBox Header="RFID Scanner" Margin="4">
                            <StackPanel Margin="4">
                                <TextBlock Margin="4">
                                    <Run Text="ID:"/>
                                    <Run Text="{Binding ScannerId,Mode=OneWay}" FontWeight="Bold"/>
                                </TextBlock>
                                <TextBlock Margin="4">
                                    <Run Text="Description:"/>
                                    <Run Text="{Binding ScannerDescription,Mode=OneWay}" FontWeight="Bold"/>
                                </TextBlock>
                                <UniformGrid Columns="2" Margin="4">
                                    <Button Content="Register" Command="{Binding RegisterCommand}"
                                            Margin="4"
                                            Visibility="{Binding IsRegistering,Converter={cnv:BooleanToVisibility Collapsed,Visible}}"
                                            Focusable="False" KeyboardNavigation.IsTabStop="False"/>
                                    <Button Content="Cancel" Command="{Binding CancelRegisterCommand}"
                                            Margin="4"
                                            Visibility="{Binding IsRegistering,Converter={cnv:BooleanToVisibility}}"
                                            Focusable="False" KeyboardNavigation.IsTabStop="False"/>
                                    <Button Content="Test Scanner" Command="{Binding TestScanCommand}"
                                            Margin="4"
                                            Focusable="False" KeyboardNavigation.IsTabStop="False"/>
                                </UniformGrid>
                            </StackPanel>
                        </GroupBox>


                        <StackPanel Margin="7">
                            <TextBlock FontWeight="Bold">
                            <Run Text="Scan Interval ("/>
                            <Run Text="{Binding Source={x:Static cnf:Config.General},Path=ScanInterval}"/>
                            <Run Text="seconds)"/>
                            </TextBlock>

                            <Slider Margin="4" Minimum="1" Interval="1"
                                Maximum="777" TickFrequency="47" TickPlacement="BottomRight"
                                Value="{Binding Source={x:Static cnf:Config.General},Path=ScanInterval}"/>

                            <TextBlock Margin="4" FontStyle="Italic" Opacity="0.7"
                                   VerticalAlignment="Center"
                                   Text="Minimum time, in seconds, between valid scans."/>
                        </StackPanel>

                        <StackPanel Margin="7">
                            <TextBlock FontWeight="Bold">
                            <Run Text="Activate Guard Mode When Idle For "/>
                            <Run Text="{Binding Source={x:Static cnf:Config.General},Path=GuardModeOnIdle}"/>
                            <Run Text="Seconds"/>
                            </TextBlock>

                            <Slider Margin="4" TickFrequency="74" Minimum="0" Interval="1"
                                Maximum="777" TickPlacement="BottomRight"
                                Value="{Binding Source={x:Static cnf:Config.General},Path=GuardModeOnIdle}"/>

                            <TextBlock Margin="4" FontStyle="Italic" Opacity="0.7"
                                   VerticalAlignment="Center"
                                   Text="Set to zero (0) seconds to disable this option."/>
                        </StackPanel>

                        <StackPanel Margin="7">
                            <CheckBox Margin="4" Content="Confirm Exit" FontWeight="Bold"
                              VerticalAlignment="Center"
                              IsChecked="{Binding Source={x:Static cnf:Config.General},Path=ConfirmExit}"/>
                            <TextBlock Margin="4" FontStyle="Italic" Opacity="0.7"
                               VerticalAlignment="Center"
                               Text="If checked, asks for confirmation when the application is closed."/>
                        </StackPanel>

                        <StackPanel Margin="7">
                            <CheckBox Margin="4" Content="Enable Guard Mode On Startup"
                                  VerticalAlignment="Center" FontWeight="Bold"
                                  IsChecked="{Binding Source={x:Static cnf:Config.General},Path=GuarModeOnStartup}"/>
                            <TextBlock Margin="4" FontStyle="Italic" Opacity="0.7"
                                   VerticalAlignment="Center"
                                   Text="Check to activate Guard Mode on startup. Uncheck to show Login Screen."/>
                        </StackPanel>

                        <StackPanel Margin="7">
                            <CheckBox Margin="4" Content="Always Show Student Info On Scan"
                                  VerticalAlignment="Center" FontWeight="Bold"
                                  IsChecked="{Binding Source={x:Static cnf:Config.General},Path=GuardModeOnScan}"/>
                            <TextBlock Margin="4 4 4 0" FontStyle="Italic" Opacity="0.7"
                                   Text="If unchecked, Student's Info will only be shown when Guard Mode is active."
                                   VerticalAlignment="Center" TextWrapping="Wrap"/>
                            <TextBlock Margin="4 0 4 4" FontStyle="Italic" Opacity="0.7"
                                   Text="NOTE: Valid scans are always recorded."
                                   VerticalAlignment="Center" TextWrapping="Wrap"/>
                        </StackPanel>

                        <StackPanel Margin="7">
                            <CheckBox Margin="4" Content="Show Guard Mode in Fullscreen"
                                  VerticalAlignment="Center" FontWeight="Bold"
                                  IsChecked="{Binding Source={x:Static cnf:Config.General},Path=GuardModeFullScreen}"/>
                            <TextBlock Margin="4" FontStyle="Italic" Opacity="0.7"
                                   VerticalAlignment="Center"
                                   Text="Check to show Guard Mode in fullscreen."/>
                        </StackPanel>

                        <GroupBox Header="Background" Margin="7" HorizontalAlignment="Left">
                            <StackPanel Orientation="Horizontal">
                                <StackPanel Margin="4">
                                    <TextBlock Text="Image" FontWeight="Bold"/>

                                    <Image Source="{Binding Source={x:Static vm:Settings.Instance},Path=BackgroundPath,Converter={cnv:PathToBitmapConverter}}"
                                   Margin="4"
                                   HorizontalAlignment="Center"
                                   Width="147" Stretch="UniformToFill"/>
                                    <Button Content="Change" Command="{Binding ChangeBackgroundCommand}"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center" Margin="4"
                                    ToolTip="Click to change the background image."/>

                                </StackPanel>
                                <StackPanel Margin="4">
                                    <TextBlock Text="Color" FontWeight="Bold"/>
                                    <local:ColorPicker SelectedColor="{Binding Source={x:Static cnf:Config.General},Path=GuardModeBackground}"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </WrapPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="SMS">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled"
                              Margin="20">
                    <WrapPanel Orientation="Vertical">
                        <StackPanel Margin="4">
                            <CheckBox Content="Enable SMS Service" IsChecked="{Binding Source={x:Static cnf:Config.Sms},Path=Enabled}"/>
                            <TextBlock Margin="4 4 4 17" FontStyle="Italic" Opacity="0.7"
                                       VerticalAlignment="Center"
                                       TextWrapping="Wrap" MaxWidth="400"
                                       Text="Check this to automatically send SMS notifications to parents or guardians when a student enters or leaves the campus."/>
                        </StackPanel>

                        <StackPanel Margin="4">
                        <TextBlock Text="School Entry Message Template" Margin="4" FontWeight="Bold"/>
                        <TextBox Margin="4" Text="{Binding Source={x:Static cnf:Config.Sms},Path=EntryTemplate}"
                                 MaxWidth="400"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="True" VerticalScrollBarVisibility="Auto"
                                         HorizontalScrollBarVisibility="Disabled"/>
                        <TextBlock Margin="4 4 4 17" FontStyle="Italic" Opacity="0.7"
                                   MaxWidth="400"
                                   MaxHeight="147"
                                           VerticalAlignment="Center">
                                    <Run Text="The message sent to parents or guardians when their students enter the school campus."/>
                        </TextBlock>
                        </StackPanel>

                        <StackPanel Margin="4">
                        <TextBlock Text="School Exit Message Template" Margin="4" FontWeight="Bold"/>
                        <TextBox Margin="4" Text="{Binding Source={x:Static cnf:Config.Sms},Path=ExitTemplate}"
                                         TextWrapping="Wrap"
                                 MaxWidth="400"
                                 MaxHeight="147"
                                         AcceptsReturn="True" VerticalScrollBarVisibility="Auto"
                                         HorizontalScrollBarVisibility="Disabled"/>
                        <TextBlock Margin="4 4 4 17" FontStyle="Italic" Opacity="0.7"
                                   MaxWidth="400"
                                           VerticalAlignment="Center">
                                    <Run Text="The message sent to parents or guardians when their students leave the school campus."/>
                        </TextBlock>

                        </StackPanel>

                        <StackPanel Margin="4">

                        <TextBlock Text="Violation Message Template" Margin="4" FontWeight="Bold"/>
                        <TextBox Margin="4" Text="{Binding Source={x:Static cnf:Config.Sms},Path=ViolationTemplate}"
                                         TextWrapping="Wrap"
                                 MaxWidth="400"
                                 MaxHeight="147"
                                         AcceptsReturn="True" VerticalScrollBarVisibility="Auto"
                                         HorizontalScrollBarVisibility="Disabled"/>
                        <TextBlock Margin="4 4 4 17" FontStyle="Italic" Opacity="0.7"
                                   MaxWidth="400"
                                           VerticalAlignment="Center">
                                    <Run Text="The message sent to parents or guardians when their students committed a violation."/>
                        </TextBlock>
                        </StackPanel>
                        
                        <GroupBox Margin="4" Header="GSM Modem">
                            <StackPanel Margin="4">
                                <TextBlock Text="Port" Margin="4" FontWeight="Bold"/>
                                <TextBox Margin="4" Text="{Binding Source={x:Static cnf:Config.Sms},Path=Port}"/>
                                <TextBlock Margin="4 4 4 17" FontStyle="Italic" Opacity="0.7"
                                           VerticalAlignment="Center">
                                    <Run Text="COM port the GSM Modem is attached into."/>
                                    <Hyperlink Command="{Binding Source={x:Static gate:Extensions.OpenModemsCommand}}">See Installed Modems.</Hyperlink>
                                </TextBlock>
                                
                                <TextBlock Text="Baudrate" Margin="4" FontWeight="Bold"/>
                                <TextBox Margin="4" Text="{Binding Source={x:Static cnf:Config.Sms},Path=Baudrate}"/>
                                <TextBlock Margin="4 4 4 17" FontStyle="Italic" Opacity="0.7"
                                           VerticalAlignment="Center"
                                           Text="The communication speed. Please check the device specification."/>
                            </StackPanel>
                        </GroupBox>

                     
                    </WrapPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <Border CornerRadius="4" HorizontalAlignment="Center"
                Visibility="{Binding Source={x:Static vm:MainViewModel.Instance},Path=CurrentUser.IsAdmin,Converter={cnv:BooleanToVisibility Collapsed,Visible}}"
                Background="#FF0000"
                VerticalAlignment="Center">
            <StackPanel Orientation="Horizontal"
                        Margin="20">
                <Path Margin="4"
                      Data="M15.396557,23.044006C14.220558,23.044006 13.268559,23.886993 13.268559,24.927994 13.268559,25.975006 14.220558,26.817001 15.396557,26.817001 16.572557,26.817001 17.523547,25.975006 17.523547,24.927994 17.523547,23.886993 16.572557,23.044006 15.396557,23.044006z M15.467541,5.1819992C15.447552,5.1819992 15.436566,5.1829987 15.436566,5.1829987 13.118533,5.5049973 13.055545,7.3330002 13.055545,7.3330002L13.055545,9.2929993 13.626531,16.539001C13.983558,18.357002 14.243538,19.020004 14.243538,19.020004 15.275555,19.975006 16.203567,19.25 16.203567,19.25 16.976548,18.565994 17.028552,16.962997 17.028552,16.962997 17.956563,9.2929993 17.696553,7.1029968 17.696553,7.1029968 17.608571,5.2839966 15.823561,5.1849976 15.490551,5.1819992 15.481549,5.1819992 15.473553,5.1819992 15.467541,5.1819992z M15.56355,0C15.56355,0 21.710574,4.1259995 31.581613,2.8030014 31.581613,2.8030014 33.634629,26.556992 15.56355,32 15.56355,32 -0.10249132,27.548004 0.00050565118,2.9670029 0.0005058694,2.9670029 10.72555,3.6309967 15.56355,0z" Stretch="Uniform" Fill="#FFFFFFFF"
                      RenderTransformOrigin="0.5,0.5"/>
                <TextBlock Text="ACCESS DENIED" Foreground="White"
                           Margin="4"
                           FontWeight="Bold" FontSize="14pt"/>
            </StackPanel>

        </Border>
    </Grid>
</UserControl>
